<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">
<meta name="referrer" content="no-referrer"/>



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-atom.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/my.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/my-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/my-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/my.png?v=5.1.4" color="#222">





  <meta name="keywords" content="Python,数据分析," />




  


  <link rel="alternate" href="/atom.xml" title="小哲知识库" type="application/atom+xml" />






<meta name="description" content="数据预处理包括数据的清洗、合并、重塑与转换，解决数据缺失、极端值、数据格式不统一等问题，本文通过介绍Pandas中专门用于进行数据预处理的函数及方法来进行数据预处理的标准流程。">
<meta property="og:type" content="article">
<meta property="og:title" content="Python数据预处理">
<meta property="og:url" content="https://vxiaozhe1998.github.io/2020/04/22/Python%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="小哲知识库">
<meta property="og:description" content="数据预处理包括数据的清洗、合并、重塑与转换，解决数据缺失、极端值、数据格式不统一等问题，本文通过介绍Pandas中专门用于进行数据预处理的函数及方法来进行数据预处理的标准流程。">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200423003202.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200423005435.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200426104631.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200427115734.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200427181516.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428220405.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428214055.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428215307.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428231255.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200429002254.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200504105735.png">
<meta property="og:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200504113452.png">
<meta property="article:published_time" content="2020-04-22T01:26:27.000Z">
<meta property="article:modified_time" content="2020-05-04T15:05:12.383Z">
<meta property="article:author" content="小哲">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="数据分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200423003202.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://vxiaozhe1998.github.io/2020/04/22/Python数据预处理/"/>





  <title>Python数据预处理 | 小哲知识库</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小哲知识库</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一个不像程序猿的设计狮</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-镜像">
          <a href="http://vxiaozhe1998.gitee.io" target="_blank" rel="section noopener">
            
              <i class="menu-item-icon fa fa-fw fa-heart"></i> <br />
            
            镜像
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            友链
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    <div class="reading-progress-bar"></div>
    

  

  
  
    
  
  

  <article class="post post-type-normal true" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://vxiaozhe1998.github.io/2020/04/22/Python%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="小哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小哲知识库">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Python数据预处理</h1>
        

        <div class="post-meta">
          <span class="post-time">
          
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-22T09:26:27+08:00">
                2020-04-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6.6k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  28
                </span>
              
            </div>
          

          
          
        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <div class="note info no-icon"><p>数据预处理包括数据的清洗、合并、重塑与转换，解决数据缺失、极端值、数据格式不统一等问题，本文通过介绍Pandas中专门用于进行数据预处理的函数及方法来进行数据预处理的标准流程。</p></div>
<a id="more"></a>
<h3 id="0-数据清洗"><a href="#0-数据清洗" class="headerlink" title="0. 数据清洗"></a>0. 数据清洗</h3><p>数据清洗是一项复杂的工作，该过程目的在于提高数据的质量，将脏数据清理干净，使数据具有完整性、唯一性、权威性、合法性、一致性等特点。Pandas常见的数据清洗操作有空值和缺失值的处理、重复值的处理、异常值的处理、统一数据格式等。</p>
<h4 id="0-1-空值和缺失值的处理"><a href="#0-1-空值和缺失值的处理" class="headerlink" title="0.1 空值和缺失值的处理"></a>0.1 空值和缺失值的处理</h4><p>空值一般表示数据未知、不适用或将在以后添加数据。缺失值是指数据集中某个或某些属性不完整主要原因有机械原因和人为原因，机械原因往往因为机器故障而人为原因可能由于人为隐瞒或录入失误而引起的。空值使用<code>None</code>表示，缺失值使用<code>NaN</code>表示，处理空值和缺失值通常有如下四个函数：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>函数名</strong></th>
<th><strong>函数效果</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>isnull()</code></td>
<td>检查空值或缺失值</td>
</tr>
<tr>
<td><code>notnull()</code></td>
<td>检查空值或缺失值</td>
</tr>
<tr>
<td><code>dropna()</code></td>
<td>删除含有空值或缺失值的行或列</td>
</tr>
<tr>
<td><code>fillna()</code></td>
<td>填充空值或缺失值</td>
</tr>
</tbody>
</table>
</div>
<h5 id="0-1-1-isnull-和notnull"><a href="#0-1-1-isnull-和notnull" class="headerlink" title="0.1.1 isnull()和notnull()"></a>0.1.1 <code>isnull()</code>和<code>notnull()</code></h5><p><code>isnull()</code>和<code>notnull()</code>参数都是只有一个，表示检查空值对象，不同之处在于<code>isnull()</code>如果检测到<code>None</code>或<code>NaN</code>则标记为<code>True</code>而<code>notnull()</code>检测到<code>None</code>或<code>NaN</code>则标记为<code>False</code>，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> NaN</span><br><span class="line">data = pd.DataFrame(</span><br><span class="line">    [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">2</span>, <span class="number">4</span>, NaN, NaN], [NaN, NaN, NaN, NaN], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>]],</span><br><span class="line">    columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line">print(data)</span><br><span class="line">print(pd.isnull(data))</span><br><span class="line">print(pd.notnull(data))</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">       <span class="string">A</span>      <span class="string">B</span>      <span class="string">C</span>      <span class="string">D</span></span><br><span class="line"><span class="number">0</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line"><span class="number">1</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line"><span class="number">2</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">3</span>   <span class="literal">True</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line">       <span class="string">A</span>      <span class="string">B</span>     <span class="string">C</span>      <span class="string">D</span></span><br><span class="line"><span class="number">0</span>   <span class="literal">True</span>  <span class="literal">False</span>  <span class="literal">True</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">1</span>   <span class="literal">True</span>   <span class="literal">True</span>  <span class="literal">True</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2</span>   <span class="literal">True</span>  <span class="literal">False</span>  <span class="literal">True</span>   <span class="literal">True</span></span><br><span class="line"><span class="number">3</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">True</span>  <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<h5 id="0-1-2-dropna"><a href="#0-1-2-dropna" class="headerlink" title="0.1.2 dropna()"></a>0.1.2 <code>dropna()</code></h5><p>该方法作用是删除含有空值或缺失值的行或列。</p>
<h6 id="语法："><a href="#语法：" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.dropna(axis=<span class="number">0</span>,how=<span class="string">'any'</span>,thresh=<span class="literal">None</span>,subset=<span class="literal">None</span>,inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>axis</code>:确定过滤行的行或列，默认为<code>0</code>。取值为<code>0</code>或<code>index</code>时删除包含缺失值或空值的行；取值为<code>1</code>或<code>columns</code>时删除包含缺失值或空值的列。</li>
<li><code>how</code>:确定过滤的标准，默认为<code>any</code>,取值为<code>any</code>时，则存在<code>NaN</code>或<code>None</code>则删除该行或该列；取值为<code>all</code>时，则所有值都为<code>NaN</code>或<code>None</code>是才删除该行或该列。</li>
<li><code>thresh</code>:表示有效数据的最小要求，如果传入了2，则是要求该行或该列至少有两个非<code>NaN</code>或<code>None</code>时将其保留。</li>
<li><code>subset</code>:表示在特定子集中的寻找<code>NaN</code>或<code>None</code></li>
<li><code>inplace</code>:表示是否在原数据上操作默认为<code>False</code>，如果设为<code>True</code>则在原数据操作，如果设为<code>False</code>则修改原数据的副本返回新的数据。</li>
</ul>
<h6 id="实例："><a href="#实例：" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> NaN</span><br><span class="line">data = pd.DataFrame(</span><br><span class="line">    [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">2</span>, <span class="number">4</span>, NaN, NaN], [NaN, NaN, NaN, NaN], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>]],</span><br><span class="line">    columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认参数</span></span><br><span class="line">print(data.dropna())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当一行/列全部都为NaN时删除该行/列</span></span><br><span class="line">print(<span class="string">"\n"</span>, data.dropna(how=<span class="string">'all'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接对原始数据操作</span></span><br><span class="line">data.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line">print(<span class="string">"\n修改后的数据为:\n"</span>, data)</span><br></pre></td></tr></table></figure>
<p><strong>输出为：</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">     A    B    C    D</span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">6.0</span>  <span class="number">7.0</span></span><br><span class="line"></span><br><span class="line">      A    B    C    D</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">3.0</span>  NaN</span><br><span class="line"><span class="number">1</span>  <span class="number">2.0</span>  <span class="number">4.0</span>  NaN  NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">6.0</span>  <span class="number">7.0</span></span><br><span class="line"></span><br><span class="line">修改后的数据为:</span><br><span class="line">      A    B    C    D</span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">6.0</span>  <span class="number">7.0</span></span><br></pre></td></tr></table></figure>
<h5 id="0-1-3-fillna"><a href="#0-1-3-fillna" class="headerlink" title="0.1.3 fillna()"></a>0.1.3 <code>fillna()</code></h5><p>该方法可实现空值或缺失值的填充。</p>
<h6 id="语法：-1"><a href="#语法：-1" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.fillna(value=<span class="literal">None</span>,methon=<span class="literal">None</span>,axis=<span class="literal">None</span>,inplace=<span class="literal">False</span>,limit=<span class="literal">None</span>,downcast=<span class="literal">None</span>,**kwargs)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>value</code>:用于填充的数值</li>
<li><code>methon</code>：表示填充方式，默认为<code>None</code>另外支持一下取值<ul>
<li><code>pad/ffill</code>:将最后一个有效数据向后传播，也就是说用缺失值前面的一个值代替缺失值。</li>
<li><code>backfill/bfill</code>:将最后一个有效值向前传播，也就是说用缺失值后面的一个值代替缺失值。</li>
</ul>
</li>
<li><code>limit</code>:可以连续填充的最大数据量，默认为<code>None</code></li>
</ul>
<blockquote>
<p><strong>注意：</strong><code>method</code>和<code>value</code>参数不能同时使用。</p>
</blockquote>
<h6 id="实例：-1"><a href="#实例：-1" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> NaN</span><br><span class="line">data = pd.DataFrame(</span><br><span class="line">    [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, NaN], [<span class="number">2</span>, <span class="number">4</span>, NaN, NaN], [NaN, NaN, NaN, NaN], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>]],</span><br><span class="line">    columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常数填充缺失值</span></span><br><span class="line">print(<span class="string">"用常数6填充缺失值:\n"</span>, data.fillna(value=<span class="string">"6"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 向下填充缺失值（前向填充)</span></span><br><span class="line">print(<span class="string">"\n前向填充缺失值:\n"</span>, data.fillna(method=<span class="string">"ffill"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定列填充缺失值</span></span><br><span class="line">print(<span class="string">"\n用常数10填充A列缺失值，用常数20填充B列缺失值:\n"</span>, data.fillna(&#123;<span class="string">'A'</span>: <span class="number">10</span>, <span class="string">'B'</span>: <span class="number">20</span>&#125;))</span><br></pre></td></tr></table></figure>
<p>输出为：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">用常数<span class="number">6</span>填充缺失值:</span><br><span class="line">    A  B  C  D</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">6</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">6</span>  <span class="number">6</span></span><br><span class="line"><span class="number">2</span>  <span class="number">6</span>  <span class="number">6</span>  <span class="number">6</span>  <span class="number">6</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">6</span>  <span class="number">7</span></span><br><span class="line"></span><br><span class="line">前向填充缺失值:</span><br><span class="line">      A    B    C    D</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">3.0</span>  NaN</span><br><span class="line"><span class="number">1</span>  <span class="number">2.0</span>  <span class="number">4.0</span>  <span class="number">3.0</span>  NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>  <span class="number">4.0</span>  <span class="number">3.0</span>  NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span>  <span class="number">2.0</span>  <span class="number">6.0</span>  <span class="number">7.0</span></span><br><span class="line"></span><br><span class="line">用常数<span class="number">10</span>填充A列缺失值，用常数<span class="number">20</span>填充B列缺失值:</span><br><span class="line">       A     B    C    D</span><br><span class="line"><span class="number">0</span>   <span class="number">1.0</span>   <span class="number">2.0</span>  <span class="number">3.0</span>  NaN</span><br><span class="line"><span class="number">1</span>   <span class="number">2.0</span>   <span class="number">4.0</span>  NaN  NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">10.0</span>  <span class="number">20.0</span>  NaN  NaN</span><br><span class="line"><span class="number">3</span>   <span class="number">1.0</span>   <span class="number">2.0</span>  <span class="number">6.0</span>  <span class="number">7.0</span></span><br></pre></td></tr></table></figure>
<h4 id="0-2-重复值的处理"><a href="#0-2-重复值的处理" class="headerlink" title="0.2 重复值的处理"></a>0.2 重复值的处理</h4><p>当数据中出现了重复值，大多数情况需要删除，例如下表中:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th><strong>id</strong></th>
<th><strong>name</strong></th>
<th><strong>height</strong></th>
<th><strong>sex</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>zz</td>
<td>160</td>
<td>男</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>yxy</td>
<td>160</td>
<td>男</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>zxy</td>
<td>170</td>
<td>女</td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>wcc</td>
<td>170</td>
<td>男</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>wcc</td>
<td>170</td>
<td>男</td>
</tr>
</tbody>
</table>
</div>
<p>显然索引为<code>3</code>和<code>4</code>的数据完全相同需要进行删除，对于重复值的处理，Pandas提供了以下两个函数:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>函数效果</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>duplicated()</code></td>
<td>标记是否有重复值</td>
</tr>
<tr>
<td><code>drop_duplicates()</code></td>
<td>删除重复值</td>
</tr>
</tbody>
</table>
</div>
<h5 id="0-2-1-duplicated-重复值标记函数"><a href="#0-2-1-duplicated-重复值标记函数" class="headerlink" title="0.2.1 duplicated()重复值标记函数"></a>0.2.1 <code>duplicated()</code>重复值标记函数</h5><h6 id="语法"><a href="#语法" class="headerlink" title="语法:"></a>语法:</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">duplicated(subset=<span class="literal">None</span>,keep=<span class="string">'first'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>subset</code>:用于识别重复的列标签或列标签序列，默认识别所有列标签。</li>
<li><code>keep</code>:删除重复值并保留第一次出现的项，取值如下：<ul>
<li><code>first</code>:从前向后查找，除了第一次出现的项其余相同的均标记为重复。（默认值）</li>
<li><code>last</code>:从后往前查找，除了最后一次出现的项其余相同的均标记为重复。</li>
<li><code>False</code>:所有相同的标记均标记为重复。</li>
</ul>
</li>
</ul>
<h6 id="实例：-2"><a href="#实例：-2" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(</span><br><span class="line">    [[<span class="number">1</span>, <span class="string">'zz'</span>, <span class="number">160</span>, <span class="string">'男'</span>], [<span class="number">2</span>, <span class="string">'yxy'</span>, <span class="number">160</span>, <span class="string">'男'</span>], [<span class="number">3</span>, <span class="string">'zxy'</span>, <span class="number">170</span>, <span class="string">'女'</span>],</span><br><span class="line">     [<span class="number">4</span>, <span class="string">'wcc'</span>, <span class="number">170</span>, <span class="string">'男'</span>], [<span class="number">4</span>, <span class="string">'wcc'</span>, <span class="number">170</span>, <span class="string">'男'</span>]],</span><br><span class="line">    columns=[<span class="string">'id'</span>, <span class="string">'name'</span>, <span class="string">'height'</span>, <span class="string">'sex'</span>])</span><br><span class="line">data_p = pd.DataFrame([</span><br><span class="line">    data.duplicated(),</span><br><span class="line">    data.duplicated(keep=<span class="string">"last"</span>),</span><br><span class="line">    data.duplicated([<span class="string">'height'</span>])</span><br><span class="line">],</span><br><span class="line">                      index=[<span class="string">'无参数'</span>, <span class="string">'从后向前查找'</span>, <span class="string">'指定height列'</span>])</span><br><span class="line">print(data_p)</span><br></pre></td></tr></table></figure>
<p>输出为:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">               <span class="number">0</span>      <span class="number">1</span>      <span class="number">2</span>      <span class="number">3</span>      <span class="number">4</span></span><br><span class="line"><span class="string">无参数</span>        <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line"><span class="string">从后向前查找</span>     <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span></span><br><span class="line"><span class="string">指定height列</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span>   <span class="literal">True</span>   <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<h5 id="0-2-2-drop-duplicates-重复值删除函数"><a href="#0-2-2-drop-duplicates-重复值删除函数" class="headerlink" title="0.2.2 drop_duplicates()重复值删除函数"></a>0.2.2 <code>drop_duplicates()</code>重复值删除函数</h5><h6 id="语法：-2"><a href="#语法：-2" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drop_duplicates(subset=<span class="literal">None</span>,keep=<span class="string">"first"</span>,inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<h6 id="实例：-3"><a href="#实例：-3" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(</span><br><span class="line">    [[<span class="number">1</span>, <span class="string">'zz'</span>, <span class="number">160</span>, <span class="string">'男'</span>], [<span class="number">2</span>, <span class="string">'yxy'</span>, <span class="number">160</span>, <span class="string">'男'</span>], [<span class="number">3</span>, <span class="string">'zxy'</span>, <span class="number">170</span>, <span class="string">'女'</span>],</span><br><span class="line">     [<span class="number">4</span>, <span class="string">'wcc'</span>, <span class="number">170</span>, <span class="string">'男'</span>], [<span class="number">4</span>, <span class="string">'wcc'</span>, <span class="number">170</span>, <span class="string">'男'</span>]],</span><br><span class="line">    columns=[<span class="string">'id'</span>, <span class="string">'name'</span>, <span class="string">'height'</span>, <span class="string">'sex'</span>])</span><br><span class="line">print(data.drop_duplicates())</span><br></pre></td></tr></table></figure>
<p>输出为：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   id name  height sex</span><br><span class="line"><span class="number">0</span>   <span class="number">1</span>   zz     <span class="number">160</span>   男</span><br><span class="line"><span class="number">1</span>   <span class="number">2</span>  yxy     <span class="number">160</span>   男</span><br><span class="line"><span class="number">2</span>   <span class="number">3</span>  zxy     <span class="number">170</span>   女</span><br><span class="line"><span class="number">3</span>   <span class="number">4</span>  wcc     <span class="number">170</span>   男</span><br></pre></td></tr></table></figure>
<h4 id="0-3-异常值的处理"><a href="#0-3-异常值的处理" class="headerlink" title="0.3 异常值的处理"></a>0.3 异常值的处理</h4><p>异常值指的是样本中的个别值，其数值明显偏离它所属样本的其余观测值：</p>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200423003202.png" alt="异常值"></p>
<p>如图，蓝色圈出来的点明显高于其他值。对于异常值的检测通常使用<code>3σ原则(拉依达准则)</code>或<code>箱型图</code>检测。</p>
<h5 id="0-3-1-基于3σ原则检测异常值"><a href="#0-3-1-基于3σ原则检测异常值" class="headerlink" title="0.3.1 基于3σ原则检测异常值"></a>0.3.1 基于<code>3σ原则</code>检测异常值</h5><p>3σ原则又称拉依达原则，它是指假设一组检测数据中只含有随机误差，对其进行计算处理得到标准偏差，按一定概率确定一个区间，凡是超过这个区间的误差都是粗大误差，在此误差范围内的数据应予以剔除，在正态分布概率公式中，<em><code>σ</code></em>表示标准差，<em><code>μ</code></em>表示平均数,<em><code>f(x)</code></em>表示正态分布函数，表达式如下:</p>
<script type="math/tex; mode=display">
f(x)=\frac{1}{\sqrt{2\pi\sigma}}e^{(-\frac{(x-\mu)^2}{2\sigma^2})}</script><p>其中正态函数的分布函数图如下所示：</p>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200423005435.png" alt="正态函数"></p>
<ul>
<li>数值分布在（<em><code>μ-σ</code></em>，<em><code>μ+σ</code></em>）中的概率为68.27%</li>
<li>数值分布在（<em><code>μ-2σ</code></em>，<em><code>μ+2σ</code></em>）中的概率为95.44%</li>
<li>数值分布在（<em><code>μ-3σ</code></em>，<em><code>μ+3σ</code></em>）中的概率为99.70%</li>
</ul>
<p>通过<em><code>3σ</code></em>原则，可以定义如下函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ser1表示传入DataFrame的某一列</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">three_sigma</span><span class="params">(ser1)</span>:</span></span><br><span class="line">    <span class="comment"># 求平均值</span></span><br><span class="line">    mean_value = ser1.mean()</span><br><span class="line">    <span class="comment"># 求标准差</span></span><br><span class="line">    std_value = ser1.std()</span><br><span class="line">    <span class="comment"># 位于(μ-3σ,μ+3σ)区间内的数据是正常的，不在该区间的数据是异常的</span></span><br><span class="line">    <span class="comment"># ser1中的数值小于μ-3σ或大于μ+3σ均为异常值</span></span><br><span class="line">    <span class="comment"># 一旦发现异常值就标注为True，否则标注为False</span></span><br><span class="line">    rule = (mean_value - <span class="number">3</span> * std_value &gt; ser1) | (mean_value + <span class="number">3</span> * std_value &lt; ser1)</span><br><span class="line">    <span class="comment"># 返回异常值的位置索引</span></span><br><span class="line">    index = np.arange(ser1.shape[<span class="number">0</span>])[rule]</span><br><span class="line">    <span class="comment"># 获取异常数据</span></span><br><span class="line">    outrange = ser1.iloc[index]</span><br><span class="line">    <span class="keyword">return</span>(outrange)</span><br></pre></td></tr></table></figure>
<p>对于一组数据例如：<code>1,2,3,4,5,1000,2,3,4,5,3,8,23,12,66</code>，通过<code>3σ原则</code>来进行检测：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">"A"</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1000</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">23</span>, <span class="number">12</span>, <span class="number">66</span>]&#125;)</span><br><span class="line">print(three_sigma(data[<span class="string">'A'</span>]))</span><br></pre></td></tr></table></figure>
<p>检测结果为：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>    <span class="number">1000</span></span><br><span class="line"><span class="attr">Name:</span> <span class="string">A,</span> <span class="attr">dtype:</span> <span class="string">int64</span></span><br></pre></td></tr></table></figure>
<h5 id="0-3-2-基于箱型图检测异常值"><a href="#0-3-2-基于箱型图检测异常值" class="headerlink" title="0.3.2 基于箱型图检测异常值"></a>0.3.2 基于箱型图检测异常值</h5><p>箱型图是一种用作显示一组数据分散情况的统计图，在箱型图中，异常值被定义为小于Q<sub>l</sub>-1.5IQR或大于Q<sub>u</sub>+1.5IQR的值。其中：</p>
<ul>
<li>Q<sub>l</sub>称为下四分位数，表示全部观察值中有四分之一的数据取值比他小</li>
<li>Q<sub>u</sub>称为上四分位数，表示全部观察值中有四分之一的数据取值比他大</li>
<li>IQR称为四分位数的间距，是上四分位数Q<sub>u</sub>与下四分位数Q<sub>l</sub>之差，其间包含了全部观察值的一半。</li>
</ul>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200426104631.png" alt="箱型图"></p>
<blockquote>
<p>离散点表示的是<strong>异常值</strong>，上界表示除异常值以外数据中最大值；下界表示除异常值以外数据中最小值。</p>
</blockquote>
<p>箱型图根据实际的数据进行绘制，对数据没有任何要求，箱型图判断异常值的标准是以四分位数和四分位距为基础。在Pandas中提供了一个<code>boxplot()</code>方法用于绘制箱型图：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">data = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">'B'</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="string">'C'</span>: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">'D'</span>: [<span class="number">1</span>, <span class="number">5</span>, <span class="number">30</span>, <span class="number">3</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">data.boxplot(column=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200427115734.png" alt="output"></p>
<blockquote>
<p>使用<code>vscode</code>或<code>pycharm</code>进行可视化需要使用绘图库，如果需要直接显示可以通过使用<code>Jupyter</code>进行快速编辑，安装教程如下:</p>
<ul>
<li><a href="https://www.jianshu.com/p/91365f343585" target="_blank" rel="noopener">Jupyter Notebook介绍、安装及使用教程</a></li>
</ul>
<p>通过在<code>Jupyter</code>中输入:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">'B'</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="string">'C'</span>: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">'D'</span>: [<span class="number">1</span>, <span class="number">5</span>, <span class="number">30</span>, <span class="number">3</span>]</span><br><span class="line">&#125;)</span><br><span class="line">data.boxplot(column=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br></pre></td></tr></table></figure>
<p>即可达到实时显示的目的：</p>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200427181516.png" alt="Jupyter"></p>
</blockquote>
<p>可以看出根据检出结果异常值被检测出，对于异常值，通常会使用以下四种方式处理异常值：</p>
<ul>
<li>删除异常值记录</li>
<li>使用具体值进行替换，例如使用前后两个观测值的平均值进行修正</li>
<li>不处理，直接在具有异常值的数据集中统计分析</li>
<li>视为缺失值，利用缺失值的处理方法修正异常值</li>
</ul>
<p>如果需要对异常值进行替换，可以使用<code>replace()</code>函数。</p>
<h6 id="replace"><a href="#replace" class="headerlink" title="replace()"></a><code>replace()</code></h6><p><strong>函数语法：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace(to_replace=<span class="literal">None</span>,value=<span class="literal">None</span>,inplace=<span class="literal">False</span>,limit=<span class="literal">None</span>,regex=<span class="literal">False</span>,method=<span class="string">'pad'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>to_replace</code>:表示查找被替换的方式</li>
<li><code>value</code>:用来替换任何匹配<code>to_replace</code>的值，默认为<code>None</code></li>
<li><code>limit</code>:表示前向或后向填充的最大尺寸间隙</li>
<li><code>regex</code>:接收布尔值或与<code>to_replace</code>相同的类型，默认为<code>False</code>，表示是否将<code>to_replace</code>和<code>value</code>解释为正则表达式。</li>
</ul>
<p><strong>实例：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'A'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">'B'</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>],</span><br><span class="line">    <span class="string">'C'</span>: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">'D'</span>: [<span class="number">1</span>, <span class="number">5</span>, <span class="number">30</span>, <span class="number">3</span>]</span><br><span class="line">&#125;)</span><br><span class="line">data.replace(to_replace=<span class="number">30</span>, value=<span class="number">3</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<p>通过<code>replace</code>方法将<code>data</code>中的异常值<code>30</code>直接在原数据集中替换为<code>3</code>，注意，<code>replace()</code>方法中的<code>to_replace</code>参数的传入值也可为列表<code>list</code></p>
<p><strong>输出：</strong></p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   A  B  C  D</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">2</span>  <span class="number">1</span>  <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">7</span>  <span class="number">3</span></span><br><span class="line"><span class="number">3</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h4 id="0-4-更改数据类型"><a href="#0-4-更改数据类型" class="headerlink" title="0.4 更改数据类型"></a>0.4 更改数据类型</h4><p>在处理数据时可能会遇到数据类型不一致的问题，对于数据类型的统一有如下三种方式：</p>
<ul>
<li>创建时指定数据类型</li>
<li><code>astype()</code>方法</li>
<li><code>numberic()</code>方法</li>
</ul>
<h5 id="0-4-1-创建时指定数据类型"><a href="#0-4-1-创建时指定数据类型" class="headerlink" title="0.4.1 创建时指定数据类型"></a>0.4.1 创建时指定数据类型</h5><p>使用<code>dtype</code>参数，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">"A"</span>: [<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>], <span class="string">"B"</span>: [<span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>]&#125;, dtype=<span class="string">'int'</span>)</span><br><span class="line">print(data.dtypes)</span><br></pre></td></tr></table></figure>
<p>可以看出输入的对象是字符型，但是通过指定<code>dtype</code>最终的对象为<code>int</code>型。</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A    <span class="built_in">int32</span></span><br><span class="line">B    <span class="built_in">int32</span></span><br><span class="line">dtype: <span class="keyword">object</span></span><br></pre></td></tr></table></figure>
<h5 id="0-4-2-astype-方法"><a href="#0-4-2-astype-方法" class="headerlink" title="0.4.2 astype()方法"></a>0.4.2 <code>astype()</code>方法</h5><h6 id="语法：-3"><a href="#语法：-3" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">astype(dtype,copy=<span class="literal">True</span>,errors=<span class="string">'raise'</span>,** kwargs)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>dtype</code>:数据类型</li>
<li><code>copy</code>:是否建立副本，默认为<code>True</code></li>
<li><code>errors</code>:错误采取的处理方式，默认为<code>raise</code>（允许引发异常），还可以设置为<code>ignore</code>(抑制异常)</li>
</ul>
<h6 id="实例：-4"><a href="#实例：-4" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">"A"</span>: [<span class="string">'1.1'</span>, <span class="string">'2.2'</span>, <span class="string">'3'</span>], <span class="string">"B"</span>: [<span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>]&#125;, dtype=<span class="string">'float'</span>)</span><br><span class="line">print(data.dtypes)</span><br><span class="line">print(data[<span class="string">'A'</span>].astype(dtype=<span class="string">'int'</span>))</span><br></pre></td></tr></table></figure>
<h6 id="输出："><a href="#输出：" class="headerlink" title="输出："></a>输出：</h6><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A    <span class="built_in">float</span>64</span><br><span class="line">B    <span class="built_in">float</span>64</span><br><span class="line">dtype: object</span><br><span class="line"><span class="number">0</span>    <span class="number">1</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">3</span></span><br><span class="line">Name: A, dtype: <span class="built_in">int</span>32</span><br></pre></td></tr></table></figure>
<h5 id="0-4-3-to-numeric"><a href="#0-4-3-to-numeric" class="headerlink" title="0.4.3 to_numeric()"></a>0.4.3 <code>to_numeric()</code></h5><p><code>astype()</code>方法存在局限性，通过<code>to_numeric()</code>函数可以将传入参数转换为数值类型。</p>
<h6 id="语法：-4"><a href="#语法：-4" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.to_numeric(arg,error=<span class="string">'raise'</span>,downcast=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>arg</code>:表示要转换的数据，可以是<code>list</code>,<code>tuple</code>,<code>Series</code></li>
<li><code>errors</code>:错误采取的处理方式</li>
</ul>
<blockquote>
<p><code>to_numeric</code>函数无法直接操作<code>DataFrame</code>对象</p>
</blockquote>
<h6 id="实例：-5"><a href="#实例：-5" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.Series([<span class="string">'1'</span>, <span class="string">'1.2'</span>, <span class="string">'3'</span>])</span><br><span class="line">print(pd.to_numeric(data).dtypes)</span><br></pre></td></tr></table></figure>
<h6 id="输出"><a href="#输出" class="headerlink" title="输出:"></a>输出:</h6><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">float</span>64</span><br></pre></td></tr></table></figure>
<h3 id="1-数据合并"><a href="#1-数据合并" class="headerlink" title="1. 数据合并"></a>1. 数据合并</h3><h4 id="1-1-轴向堆叠数据"><a href="#1-1-轴向堆叠数据" class="headerlink" title="1.1 轴向堆叠数据"></a>1.1 轴向堆叠数据</h4><p>通过使用<code>concat()</code>函数可以沿着一条轴对多个对象进行堆叠，语法格式为:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.concat(objs,axis=<span class="number">0</span>,join=<span class="string">'outer'</span>,join_axes=<span class="literal">None</span>,ignore_index=<span class="literal">False</span>,keys=<span class="literal">None</span>,levels=<span class="literal">None</span>,names=<span class="literal">None</span>,verify_integrity=<span class="literal">False</span>,sort=<span class="literal">None</span>,copy=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>axis</code>:表示连接的轴向，默认为0，还可以设置为1</li>
<li><code>join</code>:表示连接方式，<code>inner</code>表示内连接，<code>outer</code>表示外连接，默认外连接</li>
<li><code>ignore_index</code>:接收布尔值，默认为<code>False</code>，如果设置为<code>True</code>，则表示清除现有索引并重置索引值</li>
<li><code>keys</code>:接收序列，表示添加最外层索引</li>
<li><code>levels</code>:用于构建<code>MultiIndex</code>的特定级别（唯一）</li>
<li><code>names</code>:在设置了<code>keys</code>和<code>level</code>参数后，用于创建分层级别的名称</li>
<li><code>verify_integerity</code>:检查新的连接轴是否包含重复值。接收布尔值，当设置为<code>True</code>时，如果有重复的轴将会抛出错误，默认为<code>False</code></li>
</ul>
<h5 id="1-1-1-横向堆叠、纵向堆叠、内连接、外连接"><a href="#1-1-1-横向堆叠、纵向堆叠、内连接、外连接" class="headerlink" title="1.1.1 横向堆叠、纵向堆叠、内连接、外连接"></a>1.1.1 横向堆叠、纵向堆叠、内连接、外连接</h5><p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428220405.png" alt="堆叠方式"></p>
<p>横向堆叠以<code>行</code>为标准，相同名称的行保存为一行，而纵向堆叠以<code>列</code>为标准，相同名称的列保存为一列；内连接是将两个<code>DataFrame</code>对象中都有的列或行进行堆叠连接，而外连接是将两个<code>DataFrame</code>对象所有的列和行进行堆叠连接。</p>
<blockquote>
<p>横向堆叠默认不考虑列索引而纵向堆叠默认不考虑行索引，缺失值使用<code>NaN</code>填充</p>
</blockquote>
<h6 id="实例：-6"><a href="#实例：-6" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data1 = pd.DataFrame(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"A"</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        <span class="string">"B"</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>],</span><br><span class="line">        <span class="string">"C"</span>: [<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]</span><br><span class="line">    &#125;, dtype=int)</span><br><span class="line">data2 = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">"B"</span>: [<span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>],</span><br><span class="line">    <span class="string">"C"</span>: [<span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>],</span><br><span class="line">    <span class="string">"D"</span>: [<span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>]</span><br><span class="line">&#125;,</span><br><span class="line">                     dtype=int)</span><br><span class="line"><span class="comment"># 纵向外连接</span></span><br><span class="line">data3 = pd.concat([data1, data2], join=<span class="string">'outer'</span>, axis=<span class="number">0</span>)</span><br><span class="line">print(data3)</span><br></pre></td></tr></table></figure>
<h6 id="输出-1"><a href="#输出-1" class="headerlink" title="输出:"></a>输出:</h6><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">     A   B   C     D</span><br><span class="line"><span class="number">0</span>  <span class="number">0.0</span>   <span class="number">4</span>   <span class="number">8</span>   NaN</span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span>   <span class="number">5</span>   <span class="number">9</span>   NaN</span><br><span class="line"><span class="number">2</span>  <span class="number">2.0</span>   <span class="number">6</span>  <span class="number">10</span>   NaN</span><br><span class="line"><span class="number">3</span>  <span class="number">3.0</span>   <span class="number">7</span>  <span class="number">11</span>   NaN</span><br><span class="line"><span class="number">0</span>  NaN  <span class="number">12</span>  <span class="number">15</span>  <span class="number">18.0</span></span><br><span class="line"><span class="number">1</span>  NaN  <span class="number">13</span>  <span class="number">16</span>  <span class="number">19.0</span></span><br><span class="line"><span class="number">2</span>  NaN  <span class="number">14</span>  <span class="number">17</span>  <span class="number">20.0</span></span><br></pre></td></tr></table></figure>
<h4 id="1-2-主键合并数据"><a href="#1-2-主键合并数据" class="headerlink" title="1.2 主键合并数据"></a>1.2 主键合并数据</h4><p>主键合并类似于关系型数据库，根据一个或多个键将不同的<code>DataFrame</code>对象连接起来，大多数是将两个<code>DataFrame</code>对象中重叠的列作为合并的键，Pandas中提供了用于主键合并的<code>merge()</code>函数，语法为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.merge(left,right,how=<span class="string">'inner'</span>,on=<span class="literal">None</span>,left_on=<span class="literal">None</span>,right_on=<span class="literal">None</span>,left_index=<span class="literal">False</span>,right_index=<span class="literal">False</span>,sort=<span class="literal">False</span>,suffixes=(<span class="string">'_x'</span>,<span class="string">'_y'</span>),copy=<span class="literal">True</span>,indicator=<span class="literal">False</span>,validate=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>left</code>:参与合并的左侧<code>DataFrame</code>对象</li>
<li><code>right</code>:参与合并的右侧<code>DataFrame</code>对象</li>
<li><code>how</code>:表示连接方式，默认为<code>inner</code>，该参数还支持如下取值:<ul>
<li><code>left</code>:使用左侧的<code>DataFrame</code>的键，类似SQL的左外连接</li>
<li><code>right</code>:使用右侧的<code>DataFrame</code>的键，类似SQL的右外连接</li>
<li><code>outer</code>:使用两个<code>DataFrame</code>所有的键，类似于SQL全连接</li>
<li><code>inner</code>:使用两个<code>DataFrame</code>键的交集，类似于SQL内连接</li>
</ul>
</li>
<li><code>on</code>:用于连接的列名，必须存在于两个<code>DataFrame</code>对象中</li>
<li><code>left_on</code>:以左侧<code>DataFrame</code>作为连接键</li>
<li><code>right_on</code>:以右侧<code>DataFrame</code>作为连接键</li>
<li><code>left_index</code>:左侧的行索引用作连接键</li>
<li><code>right_index</code>:右侧的行索引用作连接键</li>
<li><code>sort</code>:是否排序，接收布尔值，默认为<code>False</code></li>
<li><code>suffixes</code>:用于追加到重叠列名的末尾，默认为<code>(_x,_y)</code></li>
</ul>
<blockquote>
<p>在使用<code>merge()</code>函数进行合并时默认使用重叠的列索引作为合并键，并采用内连接的方式合并数据。</p>
</blockquote>
<h5 id="1-2-1-通过主键合并"><a href="#1-2-1-通过主键合并" class="headerlink" title="1.2.1 通过主键合并"></a>1.2.1 通过主键合并</h5><p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428214055.png" alt="通过主键合并"></p>
<p>针对同一个主键存在两张不同字段的表，根据主键整合到一张表里面，例如上图中左侧两张表均有索引为<code>key</code>的一列数据，两表通过<code>key</code>列合并为一个表。即：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">top = pd.DataFrame(&#123;<span class="string">"key"</span>: [<span class="string">'k0'</span>, <span class="string">'k3'</span>, <span class="string">'k4'</span>], <span class="string">"A"</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>], <span class="string">"B"</span>: [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]&#125;)</span><br><span class="line">bottom = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">"key"</span>: [<span class="string">'k0'</span>, <span class="string">'k2'</span>, <span class="string">'k3'</span>],</span><br><span class="line">    <span class="string">"C"</span>: [<span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>],</span><br><span class="line">    <span class="string">"D"</span>: [<span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>]</span><br><span class="line">&#125;)</span><br><span class="line">print(pd.merge(top, bottom, on=<span class="string">"key"</span>))</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="type">key</span>  A  B   C   D</span><br><span class="line"><span class="number">0</span>  k0  <span class="number">1</span>  <span class="number">2</span>   <span class="number">7</span>   <span class="number">8</span></span><br><span class="line"><span class="number">1</span>  k3  <span class="number">3</span>  <span class="number">4</span>  <span class="number">11</span>  <span class="number">12</span></span><br></pre></td></tr></table></figure>
<h5 id="1-2-2-多个主键合并"><a href="#1-2-2-多个主键合并" class="headerlink" title="1.2.2 多个主键合并"></a>1.2.2 多个主键合并</h5><p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428215307.png" alt="多个主键合并"></p>
<p>通过<code>merge()</code>函数可以对含有多个重叠列的<code>DataFrame</code>对象进行合并，例如上图中使用<code>key</code>和<code>B</code>作为合并键得到右侧合并结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">top = pd.DataFrame(&#123;<span class="string">"key"</span>: [<span class="string">'k0'</span>, <span class="string">'k3'</span>, <span class="string">'k4'</span>], <span class="string">"A"</span>: [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>], <span class="string">"B"</span>: [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]&#125;)</span><br><span class="line">bottom = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">"key"</span>: [<span class="string">'k0'</span>, <span class="string">'k2'</span>, <span class="string">'k3'</span>],</span><br><span class="line">    <span class="string">"C"</span>: [<span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>],</span><br><span class="line">    <span class="string">"D"</span>: [<span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>],</span><br><span class="line">    <span class="string">"B"</span>: [<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">&#125;)</span><br><span class="line">print(pd.merge(top, bottom, on=[<span class="string">"key"</span>, <span class="string">"B"</span>]))</span><br></pre></td></tr></table></figure>
<p>输出为：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  <span class="type">key</span>  A  B  C  D</span><br><span class="line"><span class="number">0</span>  k0  <span class="number">1</span>  <span class="number">2</span>  <span class="number">7</span>  <span class="number">8</span></span><br></pre></td></tr></table></figure>
<div class="note primary no-icon"><p><strong><code>merge()</code>函数支持四种合并方式分别为<code>内连接(inner)</code>、<code>外连接(outer)</code>、<code>左连接(left)</code>、<code>右连接(right)</code>。函数中的<code>how</code>默认参数为<code>inner</code>，不同合并方式解释如下。</strong>(下列操作均针对于<code>key</code>为键值)</p>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200428231255.png" alt="连接方式"></p>
<ul>
<li><code>内连接(inner)</code>:匹配两个<code>DataFrame</code>对象中均有的键值并合并</li>
<li><code>外连接(outer)</code>:合并两个<code>DataFrame</code>对象中所有的键值，缺失值用<code>NaN</code>填充</li>
<li><code>左连接(left)</code>:以<code>merge</code>函数中第一个出现的<code>DataFrame</code>对象的指定键值为标准进行连接，第一个出现的<code>DataFrame</code>表中数据将会全部显示，而第二个出现的<code>DataFrame</code>对象只会显示与重叠数据行索引相同的数据，合并后缺失数据用<code>NaN</code>填充</li>
<li><code>右连接(right)</code>:以<code>merge</code>函数中第二个出现的<code>DataFrame</code>对象的指定键值为标准进行连接，第二个出现的<code>DataFrame</code>表中数据将会全部显示，而第一个出现的<code>DataFrame</code>对象只会显示与重叠数据行索引相同的数据，合并后缺失数据用<code>NaN</code>填充</li>
</ul>
<h6 id="示例代码："><a href="#示例代码：" class="headerlink" title="示例代码："></a>示例代码：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'key'</span>: [<span class="string">'K0'</span>, <span class="string">'K1'</span>, <span class="string">'K2'</span>],</span><br><span class="line">    <span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>, <span class="string">'A2'</span>],</span><br><span class="line">    <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>]</span><br><span class="line">&#125;)</span><br><span class="line">right = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'key'</span>: [<span class="string">'K0'</span>, <span class="string">'K1'</span>, <span class="string">'K2'</span>, <span class="string">'K3'</span>],</span><br><span class="line">    <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>, <span class="string">'B3'</span>],</span><br><span class="line">    <span class="string">'C'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>, <span class="string">'C2'</span>, <span class="string">'C3'</span>],</span><br><span class="line">    <span class="string">'D'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>, <span class="string">'D2'</span>, <span class="string">'D3'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment"># 左连接</span></span><br><span class="line">data_left = pd.merge(left, right, how=<span class="string">'left'</span>, on=<span class="string">'key'</span>)</span><br><span class="line"><span class="comment"># 右连接</span></span><br><span class="line">data_right = pd.merge(left, right, how=<span class="string">'right'</span>, on=<span class="string">'key'</span>)</span><br><span class="line"><span class="comment"># 内连接</span></span><br><span class="line">data_inner = pd.merge(left, right, how=<span class="string">'inner'</span>, on=<span class="string">'key'</span>)</span><br><span class="line"><span class="comment"># 外连接</span></span><br><span class="line">data_outer = pd.merge(left, right, how=<span class="string">'outer'</span>, on=<span class="string">'key'</span>)</span><br></pre></td></tr></table></figure></div>
<div class="note danger no-icon"><p>如果两张表行索引和列索引均没有重叠部分，可以通过将<code>merge()</code>函数的<code>left_index</code>与<code>right_index</code>均设置为<code>True</code>即可，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">left = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>], <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>]&#125;, index=[<span class="string">'a'</span>, <span class="string">'b'</span>])</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">'C'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>], <span class="string">'D'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>]&#125;)</span><br><span class="line">data = pd.merge(left, right, how=<span class="string">'outer'</span>, left_index=<span class="literal">True</span>, right_index=<span class="literal">True</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<p>输出为：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     A    <span class="keyword">B </span>   C    D</span><br><span class="line">a   A0   <span class="keyword">B0 </span> NaN  NaN</span><br><span class="line"><span class="keyword">b </span>  <span class="built_in">A1</span>   <span class="keyword">B1 </span> NaN  NaN</span><br><span class="line"><span class="number">0</span>  NaN  NaN   <span class="built_in">C0</span>   <span class="built_in">D0</span></span><br><span class="line"><span class="number">1</span>  NaN  NaN   <span class="built_in">C1</span>   <span class="built_in">D1</span></span><br></pre></td></tr></table></figure></div>
<h4 id="1-3-根据行索引合并数据"><a href="#1-3-根据行索引合并数据" class="headerlink" title="1.3 根据行索引合并数据"></a>1.3 根据行索引合并数据</h4><h5 id="1-3-1-join-方法"><a href="#1-3-1-join-方法" class="headerlink" title="1.3.1 join()方法"></a>1.3.1 <code>join()</code>方法</h5><p><code>join()</code>方法能够通过索引或者指定的列来连接<code>DataFrame</code>。</p>
<h6 id="语法：-5"><a href="#语法：-5" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">join(other,on=<span class="literal">None</span>,how=<span class="string">'left'</span>,lsuffix=<span class="string">''</span>,rsuffix=<span class="string">''</span>,sort=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>on</code>：用于连接的列名</li>
<li><code>lsuffix</code>：接收字符串，用于在左侧重叠的列名后添加后缀</li>
<li><code>rsuffix</code>：接收字符串，用于在右侧重叠的列名后添加后缀</li>
<li><code>sort</code>：接收布尔值，根据连接键对合并的数据进行排序，默认为<code>False</code></li>
</ul>
<h6 id="实例：-7"><a href="#实例：-7" class="headerlink" title="实例："></a>实例：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">left = pd.DataFrame(&#123;<span class="string">'A'</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>], <span class="string">'B'</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>]&#125;, index=[<span class="string">'a'</span>, <span class="string">'b'</span>])</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">'C'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>], <span class="string">'D'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>]&#125;)</span><br><span class="line">data = left.join(right, how=<span class="string">"outer"</span>)</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<h6 id="输出：-1"><a href="#输出：-1" class="headerlink" title="输出："></a>输出：</h6><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     A    <span class="keyword">B </span>   C    D</span><br><span class="line">a   A0   <span class="keyword">B0 </span> NaN  NaN</span><br><span class="line"><span class="keyword">b </span>  <span class="built_in">A1</span>   <span class="keyword">B1 </span> NaN  NaN</span><br><span class="line"><span class="number">0</span>  NaN  NaN   <span class="built_in">C0</span>   <span class="built_in">D0</span></span><br><span class="line"><span class="number">1</span>  NaN  NaN   <span class="built_in">C1</span>   <span class="built_in">D1</span></span><br></pre></td></tr></table></figure>
<h4 id="1-4-合并重叠数据"><a href="#1-4-合并重叠数据" class="headerlink" title="1.4 合并重叠数据"></a>1.4 合并重叠数据</h4><p>在处理数据时，当一个<code>DataFrame</code>对象出现了缺失值，对于这些缺失数据如果想要通过其他的<code>DataFrame</code>对象中的数据填充，可以通过<code>combine_first()</code>方法填充缺失数据。</p>
<h5 id="语法：-6"><a href="#语法：-6" class="headerlink" title="语法："></a>语法：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">combine_first(other)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>other</code>:用于接收填充缺失值的对象</li>
</ul>
<h5 id="实例：-8"><a href="#实例：-8" class="headerlink" title="实例："></a>实例：</h5><p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200429002254.png" alt="合并重叠数据"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> NaN</span><br><span class="line">left = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'key'</span>: [<span class="string">'K0'</span>, <span class="string">'K1'</span>, <span class="string">'K2'</span>, <span class="string">'K3'</span>],</span><br><span class="line">    <span class="string">'A'</span>: [<span class="string">'A0'</span>, NaN, <span class="string">'A2'</span>, <span class="string">'A3'</span>],</span><br><span class="line">    <span class="string">'B'</span>: [NaN, <span class="string">'B1'</span>, NaN, <span class="string">'B3'</span>]</span><br><span class="line">&#125;)</span><br><span class="line">right = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'A'</span>: [<span class="string">'C0'</span>, <span class="string">'C1'</span>, <span class="string">'C2'</span>],</span><br><span class="line">    <span class="string">'B'</span>: [<span class="string">'D0'</span>, <span class="string">'D1'</span>, <span class="string">'D2'</span>]</span><br><span class="line">&#125;,</span><br><span class="line">                     index=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>])</span><br><span class="line">print(left.combine_first(right))</span><br></pre></td></tr></table></figure>
<h5 id="输出：-2"><a href="#输出：-2" class="headerlink" title="输出："></a>输出：</h5><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    A   <span class="keyword">B </span>key</span><br><span class="line"><span class="number">0</span>  A0  <span class="built_in">D2</span>  K0</span><br><span class="line"><span class="number">1</span>  <span class="built_in">C0</span>  <span class="keyword">B1 </span> K1</span><br><span class="line"><span class="number">2</span>  <span class="built_in">A2</span>  <span class="built_in">D1</span>  K2</span><br><span class="line"><span class="number">3</span>  <span class="built_in">A3</span>  <span class="keyword">B3 </span> K3</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用<code>combine_first</code>方法合并两个<code>DataFrame</code>对象时，必须确保他们的行索引和列索引有重叠部分</p>
</blockquote>
<h3 id="2-数据重塑"><a href="#2-数据重塑" class="headerlink" title="2. 数据重塑"></a>2. 数据重塑</h3><p>在<code>Pandas</code>中大多数情况<code>DataFrame</code>对象更便于操作，因为<code>DataFrame</code>对象很容易获取每行或每列的数据。但是有时候需要将<code>DataFrame</code>对象转换为<code>Series</code>对象，因此需要对数据进行重塑。</p>
<h4 id="2-1-重塑层次化索引"><a href="#2-1-重塑层次化索引" class="headerlink" title="2.1 重塑层次化索引"></a>2.1 重塑层次化索引</h4><p>重塑层次化索引的操作主要是<code>stack()</code>方法和<code>unstack()</code>方法，前者是将数据的列旋转为行，后者是将数据的行旋转成列。</p>
<h5 id="2-1-1-stack-方法"><a href="#2-1-1-stack-方法" class="headerlink" title="2.1.1 stack()方法"></a>2.1.1 <code>stack()</code>方法</h5><h6 id="语法：-7"><a href="#语法：-7" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.stack(level=<span class="number">-1</span>,dropna=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>level</code>:表示操作的内层索引，若设置为0，表示操作外层索引，默认为-1</li>
<li><code>dropna</code>:表示是否将旋转后的缺失值删除，默认为<code>True</code>（过滤缺失值）</li>
</ul>
<h6 id="实例：-9"><a href="#实例：-9" class="headerlink" title="实例："></a>实例：</h6><p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200504105735.png" alt="重塑"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">"A"</span>: [<span class="string">'A0'</span>, <span class="string">'A1'</span>, <span class="string">'A2'</span>], <span class="string">"B"</span>: [<span class="string">'B0'</span>, <span class="string">'B1'</span>, <span class="string">'B2'</span>]&#125;)</span><br><span class="line">result = data.stack()</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>  A    <span class="built_in">A0</span></span><br><span class="line">   <span class="keyword">B </span>   <span class="keyword">B0</span></span><br><span class="line"><span class="keyword">1 </span> A    <span class="built_in">A1</span></span><br><span class="line">   <span class="keyword">B </span>   <span class="keyword">B1</span></span><br><span class="line"><span class="keyword">2 </span> A    <span class="built_in">A2</span></span><br><span class="line">   <span class="keyword">B </span>   <span class="keyword">B2</span></span><br></pre></td></tr></table></figure>
<p>通过：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(type(result))</span><br></pre></td></tr></table></figure>
<p>可查看结果为：</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">class</span> <span class="string">'pandas.core.series.Series'</span>&gt;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-2-unstack方法"><a href="#2-1-2-unstack方法" class="headerlink" title="2.1.2 unstack方法"></a>2.1.2 <code>unstack</code>方法</h5><h6 id="语法：-8"><a href="#语法：-8" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.unstack(level=<span class="number">-1</span>,fill_value=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fill_value</code>:若产生了缺失值，则可以设置这个参数用来替换<code>NaN</code></li>
</ul>
<h6 id="实例：-10"><a href="#实例：-10" class="headerlink" title="实例："></a>实例：</h6><p>将上例中还原：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(result.unstack())</span><br></pre></td></tr></table></figure>
<h6 id="输出：-3"><a href="#输出：-3" class="headerlink" title="输出："></a>输出：</h6><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    A   <span class="keyword">B</span></span><br><span class="line"><span class="keyword">0 </span> <span class="built_in">A0</span>  <span class="keyword">B0</span></span><br><span class="line"><span class="keyword">1 </span> <span class="built_in">A1</span>  <span class="keyword">B1</span></span><br><span class="line"><span class="keyword">2 </span> <span class="built_in">A2</span>  <span class="keyword">B2</span></span><br></pre></td></tr></table></figure>
<div class="note danger no-icon"><p>可以使用<code>stack</code>对多层索引进行重塑。</p>
<p><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200504113452.png" alt="多层索引"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">data = pd.DataFrame(np.array([[<span class="number">26</span>, <span class="number">20</span>, <span class="number">22</span>, <span class="number">26</span>], [<span class="number">30</span>, <span class="number">25</span>, <span class="number">24</span>, <span class="number">20</span>]]),</span><br><span class="line">                    index=[<span class="string">'男生人数'</span>, <span class="string">'女生人数'</span>],</span><br><span class="line">                    columns=[[<span class="string">'一楼'</span>, <span class="string">'一楼'</span>, <span class="string">'二楼'</span>, <span class="string">'二楼'</span>],</span><br><span class="line">                             [<span class="string">'A教室'</span>, <span class="string">'B教室'</span>, <span class="string">'A教室'</span>, <span class="string">'B教室'</span>]])</span><br><span class="line">result = data.stack()</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">          一楼  二楼</span><br><span class="line">男生人数 A教室  <span class="number">26</span>  <span class="number">22</span></span><br><span class="line">     B教室  <span class="number">20</span>  <span class="number">26</span></span><br><span class="line">女生人数 A教室  <span class="number">30</span>  <span class="number">24</span></span><br><span class="line">     B教室  <span class="number">25</span>  <span class="number">20</span></span><br></pre></td></tr></table></figure></div>
<h4 id="2-2-轴向旋转"><a href="#2-2-轴向旋转" class="headerlink" title="2.2 轴向旋转"></a>2.2 轴向旋转</h4><h5 id="2-2-1-pivot方法"><a href="#2-2-1-pivot方法" class="headerlink" title="2.2.1 pivot方法"></a>2.2.1 <code>pivot</code>方法</h5><p><code>pivot</code>方法提供的功能是根据给定行索引或列索引重新组织一个<code>DataFrame</code>对象。</p>
<h6 id="语法：-9"><a href="#语法：-9" class="headerlink" title="语法："></a>语法：</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.pivot(index=<span class="literal">None</span>,columns=<span class="literal">None</span>,values=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>index</code>:用于创建新<code>DataFrame</code>对象的行索引，如果未设置，则使用原<code>DataFrame</code>对象的索引。</li>
<li><code>columns</code>:列索引</li>
<li><code>values</code>:值</li>
</ul>
<h6 id="实例：-11"><a href="#实例：-11" class="headerlink" title="实例："></a>实例：</h6><div class="table-container">
<table>
<thead>
<tr>
<th>出售日期</th>
<th>商品名称</th>
<th>价格(元)</th>
</tr>
</thead>
<tbody>
<tr>
<td>2017年5月25日</td>
<td>荣耀9青春版</td>
<td>999</td>
</tr>
<tr>
<td>2017年5月25日</td>
<td>小米6x</td>
<td>1399</td>
</tr>
<tr>
<td>2017年5月25日</td>
<td>OPPO A1</td>
<td>1399</td>
</tr>
<tr>
<td>2017年6月18日</td>
<td>荣耀9青春版</td>
<td>800</td>
</tr>
<tr>
<td>2017年6月18日</td>
<td>小米6x</td>
<td>1200</td>
</tr>
<tr>
<td>2017年6月18日</td>
<td>OPPO A1</td>
<td>1250</td>
</tr>
</tbody>
</table>
</div>
<p>将上述表格转化为下表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">商品名称     <br />出售日期</th>
<th style="text-align:center">荣耀9青春版</th>
<th style="text-align:center">小米6x</th>
<th style="text-align:center">OPPO A1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2017年5月25日</td>
<td style="text-align:center">999</td>
<td style="text-align:center">1399</td>
<td style="text-align:center">1399</td>
</tr>
<tr>
<td style="text-align:center">2017年6月18日</td>
<td style="text-align:center">800</td>
<td style="text-align:center">1200</td>
<td style="text-align:center">1250</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.read_excel(<span class="string">'./ProductInfo.xlsx'</span>)</span><br><span class="line">result = data.pivot(index=<span class="string">"出售日期"</span>, columns=<span class="string">"商品名称"</span>, values=<span class="string">"价格(元)"</span>)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<h3 id="3-数据转换"><a href="#3-数据转换" class="headerlink" title="3. 数据转换"></a>3. 数据转换</h3><p>当数据进行清洗之后，需要对数据进行一些合理的转换，使这些数据更符合分析的要求。</p>
<h4 id="3-1-重命名轴索引"><a href="#3-1-重命名轴索引" class="headerlink" title="3.1 重命名轴索引"></a>3.1 重命名轴索引</h4><p>重命名轴索引是数据分析中比较常见的操作，可以通过<code>rename()</code>方法重命名个别列索引或行索引的标签或名称。</p>
<h5 id="3-1-1-语法格式："><a href="#3-1-1-语法格式：" class="headerlink" title="3.1.1 语法格式："></a>3.1.1 语法格式：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename(mapper=<span class="literal">None</span>,index=<span class="literal">None</span>,columns=<span class="literal">None</span>,axis=<span class="literal">None</span>,copy=<span class="literal">True</span>,inplace=<span class="literal">False</span>,level=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>index,columns</code>:表示待转换的行索引和列索引</li>
<li><code>axis</code>:表示轴的名称，可以使用<code>index</code>或<code>columns</code>，也可以使用数字0或1</li>
<li><code>copy</code>:表示是否复制底层的数据，默认为<code>False</code></li>
<li><code>inplace</code>:默认为<code>False</code>，表示是否返回新的<code>Pandas</code>对象，如果设置为<code>True</code>，则会忽略复制的值</li>
<li><code>level</code>:表示级别的名称，默认为<code>None</code>。对于多级索引，只重命名指定的标签。</li>
</ul>
<h5 id="3-1-2-实例"><a href="#3-1-2-实例" class="headerlink" title="3.1.2 实例"></a>3.1.2 实例</h5><blockquote>
<p>将下列表格列索引更改为<code>a</code>,<code>b</code>,<code>c</code></p>
</blockquote>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>1</td>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>2</td>
<td>7</td>
<td>8</td>
<td>9</td>
</tr>
<tr>
<td>3</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">"A"</span>: [<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">10</span>],</span><br><span class="line">    <span class="string">"B"</span>: [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>],</span><br><span class="line">    <span class="string">"C"</span>: [<span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span>]</span><br><span class="line">&#125;)</span><br><span class="line">result = data.rename(str.lower, axis=<span class="string">"columns"</span>)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<h5 id="3-1-3-输出"><a href="#3-1-3-输出" class="headerlink" title="3.1.3 输出"></a>3.1.3 输出</h5><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    a   b   c</span><br><span class="line"><span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line"><span class="number">1</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span></span><br><span class="line"><span class="number">2</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span></span><br><span class="line"><span class="number">3</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span></span><br></pre></td></tr></table></figure>
<h5 id="3-1-4-其他说明"><a href="#3-1-4-其他说明" class="headerlink" title="3.1.4 其他说明"></a>3.1.4 其他说明</h5><p>使用<code>rename()</code>方法也可以对行索引进行重命名：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result_s = result.rename(index=&#123;<span class="number">1</span>: <span class="string">'a'</span>, <span class="number">2</span>: <span class="string">'b'</span>&#125;)</span><br><span class="line">print(result_s)</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    a   b   c</span><br><span class="line"><span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></span><br><span class="line">a   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span></span><br><span class="line">b   <span class="number">7</span>   <span class="number">8</span>   <span class="number">9</span></span><br><span class="line"><span class="number">3</span>  <span class="number">10</span>  <span class="number">11</span>  <span class="number">12</span></span><br></pre></td></tr></table></figure>
<h4 id="3-2-离散化连续数据"><a href="#3-2-离散化连续数据" class="headerlink" title="3.2 离散化连续数据"></a>3.2 离散化连续数据</h4><p>有时候我们需要将数据进行离散化，可以使用<code>cut()</code>函数。</p>
<h5 id="3-2-1-函数语法："><a href="#3-2-1-函数语法：" class="headerlink" title="3.2.1 函数语法："></a>3.2.1 函数语法：</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.cut(x,bins,right=<span class="literal">True</span>,labels=<span class="literal">None</span>,retbins=<span class="literal">False</span>,precision=<span class="number">3</span>,include_lowest=<span class="literal">False</span>,duplicates=<span class="string">'raise'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>x</code>:表示要分箱的数组，必须是一维的</li>
<li><code>bins</code>:接收int和序列类型的数据</li>
<li><code>right</code>:是否包含右端点，默认包含</li>
<li><code>labels</code>:用于生成区间的标签</li>
<li><code>retbins</code>:是否返回bin</li>
<li><code>precision</code>:精度，默认保留三位小数</li>
<li><code>include_lowest</code>:是否包含左端点</li>
</ul>
<h5 id="3-2-2-实例"><a href="#3-2-2-实例" class="headerlink" title="3.2.2 实例"></a>3.2.2 实例</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">ages = [<span class="number">20</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">37</span>, <span class="number">31</span>, <span class="number">61</span>, <span class="number">45</span>, <span class="number">32</span>]</span><br><span class="line">bins = [<span class="number">0</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">60</span>, <span class="number">100</span>]</span><br><span class="line">cuts = pd.cut(ages, bins)</span><br><span class="line">print(cuts)</span><br></pre></td></tr></table></figure>
<h5 id="3-2-3-输出"><a href="#3-2-3-输出" class="headerlink" title="3.2.3 输出"></a>3.2.3 输出</h5><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="number">18</span>, <span class="number">25</span>], (<span class="number">18</span>, <span class="number">25</span>], (<span class="number">18</span>, <span class="number">25</span>], (<span class="number">25</span>, <span class="number">35</span>], (<span class="number">18</span>, <span class="number">25</span>], ..., (<span class="number">35</span>, <span class="number">60</span>], (<span class="number">25</span>, <span class="number">35</span>], (<span class="number">60</span>, <span class="number">100</span>], (<span class="number">35</span>, <span class="number">60</span>], (<span class="number">25</span>, <span class="number">35</span>]]</span><br><span class="line">Length: <span class="number">11</span></span><br><span class="line">Categories (<span class="number">5</span>, <span class="built_in">int</span>erval[<span class="built_in">int</span>64]): [(<span class="number">0</span>, <span class="number">18</span>] &lt; (<span class="number">18</span>, <span class="number">25</span>] &lt; (<span class="number">25</span>, <span class="number">35</span>] &lt; (<span class="number">35</span>, <span class="number">60</span>] &lt; (<span class="number">60</span>, <span class="number">100</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="3-3-哑变量处理类别型数据"><a href="#3-3-哑变量处理类别型数据" class="headerlink" title="3.3 哑变量处理类别型数据"></a>3.3 哑变量处理类别型数据</h4><p>在Pandas中，可以使用<code>get_dummies()</code>函数对类别特征进行哑变量处理。语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.get_dummies(data,prefix=<span class="literal">None</span>,prefix_sep=<span class="string">'_'</span>,dummy_na=<span class="literal">False</span>,columns=<span class="literal">None</span>,sparse=<span class="literal">False</span>,drop_first=<span class="literal">False</span>,dtype=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>data</code>:可接收数组，<code>DataFrame</code>或<code>Serise</code>对象，表示哑变量处理的数据</li>
<li><code>prefix</code>:表示列名的前缀，默认为None</li>
<li><code>prefix_sep</code>:用于附加前缀作为分隔符，默认为<code>_</code></li>
<li><code>dummy_na</code>:表示是否为NaN值添加一列，默认为False</li>
<li><code>sparse</code>:表示虚拟列是否是稀疏的，默认为False</li>
<li><code>drop_first</code>:是否通过从k个分类级别中删除第一个级来获得k-1个分类级别，默认为False</li>
</ul>
<p>例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">data = pd.DataFrame(&#123;<span class="string">"职业"</span>: [<span class="string">"工人"</span>, <span class="string">"学生"</span>, <span class="string">"司机"</span>, <span class="string">"教师"</span>, <span class="string">"导游"</span>]&#125;)</span><br><span class="line">print(pd.get_dummies(data, prefix=[<span class="string">'col_'</span>]))</span><br></pre></td></tr></table></figure>
<p>输出为：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">   col__司机  col__学生  col__导游  col__工人  col__教师</span><br><span class="line"><span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">1</span>        <span class="number">0</span></span><br><span class="line"><span class="number">1</span>        <span class="number">0</span>        <span class="number">1</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line"><span class="number">2</span>        <span class="number">1</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span></span><br><span class="line"><span class="number">3</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">1</span></span><br><span class="line"><span class="number">4</span>        <span class="number">0</span>        <span class="number">0</span>        <span class="number">1</span>        <span class="number">0</span>        <span class="number">0</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    
      <div>
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2020/04/22/Python%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/">Python数据预处理   <i class="fa fa-arrow-up"></i></a></p>
  <p><span>文章作者:</span><a href="/" title="访问 小哲 的个人博客">小哲    <i class="fa fa-user"></i></a></p>
  <p><span>发布时间:</span>2020年04月22日 - 09:26</p>
  <p><span>最后更新:</span>2020年05月04日 - 23:05</p>
  <p><span>原始链接:</span><i class="fa fa-clipboard" data-clipboard-text="https://vxiaozhe1998.github.io/2020/04/22/Python%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/"  aria-label="复制成功！">&nbsp;点击复制原始链接</i></p>
  <!--<a class="link" href="https://vxiaozhe1998.github.io/2020/04/22/Python%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/" title="Python数据预处理">https://vxiaozhe1998.github.io/2020/04/22/Python%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-->
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">协议</a>-转载请保留原文链接及<a href="https://ame1314.github.io/about/" target="_blank">作者</a></p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
    });
    });  
</script>

      </div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="小哲 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="小哲 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"><i class="fa fa-tag"></i> Python</a>
          
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" rel="tag"><i class="fa fa-tag"></i> 数据分析</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/04/13/Pandas/" rel="next" title="Pandas">
                <i class="fa fa-chevron-left"></i> Pandas
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/04/27/Python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="prev" title="Python数据可视化">
                Python数据可视化 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">小哲</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">55</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/AME1314" target="_blank" title="GitHub">
                      GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:957798624@qq.com" target="_blank" title="E-Mail">
                      E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/me1314-28/activities" target="_blank" title="知乎">
                      知乎</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/302bb46f2381" target="_blank" title="简书">
                      简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://qm.qq.com/cgi-bin/qm/qr?k=2--mYdSVUaf_g94-fgsqPbsiyehFYYVI" target="_blank" title="QQ">
                      QQ</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-heartbeat"></i>
                
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://vxiaozhe1998.gitee.io/ourstory" title="致我亲爱的她" target="_blank">致我亲爱的她</a>
                  </li>
                
              </ul>
            </div>
          

<!-- CloudCalendar -->
<div class="widget-wrap" style="width: 90%;margin-left: auto;margin-right: auto; opacity: 0.97;">
	<div class="widget" id="CloudCalendar"></div>
</div>

          
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#0-数据清洗"><span class="nav-text">0. 数据清洗</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0-1-空值和缺失值的处理"><span class="nav-text">0.1 空值和缺失值的处理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0-1-1-isnull-和notnull"><span class="nav-text">0.1.1 isnull()和notnull()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-1-2-dropna"><span class="nav-text">0.1.2 dropna()</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法："><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例："><span class="nav-text">实例：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-1-3-fillna"><span class="nav-text">0.1.3 fillna()</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-1"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-1"><span class="nav-text">实例：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0-2-重复值的处理"><span class="nav-text">0.2 重复值的处理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0-2-1-duplicated-重复值标记函数"><span class="nav-text">0.2.1 duplicated()重复值标记函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法"><span class="nav-text">语法:</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-2"><span class="nav-text">实例：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-2-2-drop-duplicates-重复值删除函数"><span class="nav-text">0.2.2 drop_duplicates()重复值删除函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-2"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-3"><span class="nav-text">实例：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0-3-异常值的处理"><span class="nav-text">0.3 异常值的处理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0-3-1-基于3σ原则检测异常值"><span class="nav-text">0.3.1 基于3σ原则检测异常值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-3-2-基于箱型图检测异常值"><span class="nav-text">0.3.2 基于箱型图检测异常值</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#replace"><span class="nav-text">replace()</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0-4-更改数据类型"><span class="nav-text">0.4 更改数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0-4-1-创建时指定数据类型"><span class="nav-text">0.4.1 创建时指定数据类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-4-2-astype-方法"><span class="nav-text">0.4.2 astype()方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-3"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-4"><span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#输出："><span class="nav-text">输出：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0-4-3-to-numeric"><span class="nav-text">0.4.3 to_numeric()</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-4"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-5"><span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#输出"><span class="nav-text">输出:</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-数据合并"><span class="nav-text">1. 数据合并</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-轴向堆叠数据"><span class="nav-text">1.1 轴向堆叠数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-1-1-横向堆叠、纵向堆叠、内连接、外连接"><span class="nav-text">1.1.1 横向堆叠、纵向堆叠、内连接、外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-6"><span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#输出-1"><span class="nav-text">输出:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-主键合并数据"><span class="nav-text">1.2 主键合并数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2-1-通过主键合并"><span class="nav-text">1.2.1 通过主键合并</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2-2-多个主键合并"><span class="nav-text">1.2.2 多个主键合并</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#示例代码："><span class="nav-text">示例代码：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-根据行索引合并数据"><span class="nav-text">1.3 根据行索引合并数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-3-1-join-方法"><span class="nav-text">1.3.1 join()方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-5"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-7"><span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#输出：-1"><span class="nav-text">输出：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-合并重叠数据"><span class="nav-text">1.4 合并重叠数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#语法：-6"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#实例：-8"><span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#输出：-2"><span class="nav-text">输出：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-数据重塑"><span class="nav-text">2. 数据重塑</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-重塑层次化索引"><span class="nav-text">2.1 重塑层次化索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-1-stack-方法"><span class="nav-text">2.1.1 stack()方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-7"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-9"><span class="nav-text">实例：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-2-unstack方法"><span class="nav-text">2.1.2 unstack方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-8"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-10"><span class="nav-text">实例：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#输出：-3"><span class="nav-text">输出：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-轴向旋转"><span class="nav-text">2.2 轴向旋转</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-1-pivot方法"><span class="nav-text">2.2.1 pivot方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#语法：-9"><span class="nav-text">语法：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#实例：-11"><span class="nav-text">实例：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-数据转换"><span class="nav-text">3. 数据转换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-重命名轴索引"><span class="nav-text">3.1 重命名轴索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-1-语法格式："><span class="nav-text">3.1.1 语法格式：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-2-实例"><span class="nav-text">3.1.2 实例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-3-输出"><span class="nav-text">3.1.3 输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-4-其他说明"><span class="nav-text">3.1.4 其他说明</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-离散化连续数据"><span class="nav-text">3.2 离散化连续数据</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-函数语法："><span class="nav-text">3.2.1 函数语法：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-2-实例"><span class="nav-text">3.2.2 实例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-3-输出"><span class="nav-text">3.2.3 输出</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-哑变量处理类别型数据"><span class="nav-text">3.3 哑变量处理类别型数据</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
          <div class="theme-info" style="color:rgb(255, 118, 117)"><a class="my-love" target="_blank" href="http://vxiaozhe1998.gitee.io/ourstory"><i class="fa fa-heartbeat" aria-hidden="true"></i>&nbsp;&nbsp;致我最亲爱的她&nbsp;&nbsp;</a></div>

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
&nbsp;|&nbsp;<span class="with-love">
    <i class="fa fa-star"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小哲</span>

  
 &nbsp;|&nbsp;
<i class="fa fa-pencil"></i> &nbsp;<span class="post-count">博客全站共94.7k字</span>
</div>

<span class="post-count">备案号：<a href="http://beian.miit.gov.cn" target="_blank" rel="noopener">鲁ICP备20010439号</a></span>
<div>
<a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=37028302000737" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="https://gitee.com/Vxiaozhe1998/Pic/raw/master/img/20200408003236.png" class="Police" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px;">鲁公网安备 37028302000737号</p></a>
</div>

  <script src='https://unpkg.com/mermaid@8.4.8/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default","startOnLoad":true});
    }
  </script>











        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  














  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
    
      flOptions = {};
      
          flOptions.iconStyle = "default";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleLeft";
      
          flOptions.networks = "Weibo,Douban,QQZone,Linkedin,renren,Wechat,QQ";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

  <!-- calendar widget -->


    <script src="/lib/CloudCalendar/CloudCalendar.js"></script>
    <script src="/lib/CloudCalendar/languages.js"></script>
    <script type="text/javascript">
    $(function() {
        $('#CloudCalendar').aCalendar('zh-CN', 
            $.extend(
                '', {
                    single:true,
                    root:'/calendar/'
                }
            )
        );
    });
    </script>



  
  <style>
    .copy-btn {
        display: inline-block;
        cursor: pointer;
        background-color: #ecedf0;
        border: none;
        border-radius: 3px;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-appearance: none;
        font-size: 13px;
        font-weight: 700;
        line-height: 20px;
        color: #333;
        -webkit-transition: opacity .3s ease-in-out;
        -o-transition: opacity .3s ease-in-out;
        transition: opacity .3s ease-in-out;
        padding: 2px 6px;
        position: absolute;
        opacity: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 10px;
      top: 9px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('<i class="fa fa-clipboard"></i>  复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('')
          $b.append('<i class="fa fa-clipboard"></i>  复制')
        }, 300)
      }).append(e)
    })
  </script>

  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>
